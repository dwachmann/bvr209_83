<?xml version="1.0" encoding="ISO-8859-1" ?>
<!-- 
     $Id$
     
     Copyright (C) 2008-2009 Dorothea Wachmann
     
     This program is free software: you can redistribute it and/or modify
     it under the terms of the GNU General Public License as published by
     the Free Software Foundation, either version 3 of the License, or
     (at your option) any later version.
     
     This program is distributed in the hope that it will be useful,
     but WITHOUT ANY WARRANTY; without even the implied warranty of
     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
     GNU General Public License for more details.
     
     You should have received a copy of the GNU General Public License
     along with this program.  If not, see http://www.gnu.org/licenses/.
  -->
<versions xmlns="http://bvr20983.berlios.de"
          xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
          xsi:schemaLocation="http://bvr20983.berlios.de versions.xsd"
>
  <parameter name="filenamepattern">#{LCase("${../../../@id}")}.${../../../v:version/@major}.${../../@id}.${../../v:version/@major}</parameter>
  <parameter name="filenamepattern1">#{LCase("${../../@id}")}.${../../v:version/@major}</parameter>
  <parameter name="guidpattern">${../../../../v:no/text()}-#{zerofill("${../../../../v:version/@major}",4)}-${../../v:no/text()}-${../../@typeid}-#{zerofill("${../../v:version/@major}",4)}FFFFFFFF</parameter>

  <parameter name="typelibguidpattern">${../../../../v:no/text()}-#{zerofill("${../../../../v:version/@major}",4)}-${../../v:no/text()}-${../../@typeid}-FFFFFFFFFFFF</parameter>
  
  <parameter name="msicomppattern">${../../../v:no/text()}-#{zerofill("${../../../v:version/@major}",4)}-0103-${../../v:no/text()}-#{zerofill("${../../v:version/@major}",4)}#{zerofill("${../../v:version/@minor}",4)}#{zerofill("${../../v:version/@fix}",4)}</parameter>
  <parameter name="msiprodpattern">${../../v:no/text()}-#{zerofill("${../../v:version/@major}",4)}-0100-${../../v:msino/text()}-FFFFFFFFFFFF</parameter>
  <parameter name="msipackpattern">${../../v:no/text()}-#{zerofill("${../../v:version/@major}",4)}-0101-#{zerofill("${../../v:version/@minor}",4)}-#{zerofill("${../../v:version/@fix}",4)}FFFFFFFF</parameter>

<!--  <parameter name="msiupdpattern">${../../v:no/text()}-#{zerofill("${../../v:version/@major}",4)}-0102-FFFF-FFFFFFFFFFFF</parameter> -->
  <parameter name="msiupdpattern">${../../v:no/text()}-0001-0102-FFFF-FFFFFFFFFFFF</parameter>

  <product id="BVR20983">
    <version major="1" minor="0" fix="0" rev="${rev}"/>
    <name>BVR2098 Suite</name>
    <no>BFE20983</no>
    <company>Dorothea Wachmann</company>
    <copyright>Copyright \251 2008-2009 ${../../v:company/text()}</copyright>
    <filename>${filenamepattern1}</filename>
    <msipackagecode>${msipackpattern}</msipackagecode>
    <msiproductcode>${msiprodpattern}</msiproductcode>
    <msiupgradecode>${msiupdpattern}</msiupgradecode>
    <msino>0001</msino>

    <patch template="Property.tmpl" filename="Property.idt">
      <pattern><key>@ProductCode@</key><value>${../../../../v:msiproductcode/text()}</value></pattern>
      <pattern><key>@ProductName@</key><value>${../../../../v:name/text()}</value></pattern>
      <pattern><key>@Manufacturer@</key><value>${../../../../v:company/text()}</value></pattern>
      <pattern><key>@ProductVersion@</key><value>${../../../../v:version/@major}.${../../../../v:version/@minor}.0</value></pattern>
      <pattern><key>@ProductId@</key><value>#{UCase("${../../../../@id}")}</value></pattern>
      <pattern><key>@URL@</key><value>http://#{LCase("${../../../../@id}")}.berlios.de/</value></pattern>
      <pattern><key>@URL1@</key><value>http://developer.berlios.de/projects/#{LCase("${../../../../@id}")}</value></pattern>
      <pattern><key>@URL2@</key><value>http://svn.berlios.de/wsvn/#{LCase("${../../../../@id}")}</value></pattern>
      <pattern><key>@UpgradeCode@</key><value>#{UCase("${../../../../v:msiupgradecode/text()}")}</value></pattern>
    </patch>

    <patch template="Registry.tmpl" filename="Registry0.tmpl">
      <pattern><key>@ProductId@</key><value>#{LCase("${../../../../@id}")}.${../../../../v:version/@major}</value></pattern>
      <pattern><key>@LstypeinfoID@</key><value>lstypeinfo.${../../../../v:component[@id='lstypeinfo']/v:version/@major}</value></pattern>
      <pattern><key>@LsstgID@</key><value>lsstg.${../../../../v:component[@id='lsstg']/v:version/@major}</value></pattern>
      <pattern><key>@CCID@</key><value>cc.${../../../../v:component[@id='cc']/v:version/@major}</value></pattern>
      <pattern><key>@SCID@</key><value>sc.${../../../../v:component[@id='sc']/v:version/@major}</value></pattern>
    </patch>

    <patch template="Directory.tmpl" filename="Directory.idt">
      <pattern><key>@ProductId@</key><value>#{LCase("${../../../../@id}")}.${../../../../v:version/@major}</value></pattern>
    </patch>

    <patch template="Makefile.inc.tmpl" filename="Makefile.inc">
      <pattern><key>@bvr20983resresult</key><value>${../../../../v:component[@id='res']/v:filename/text()}</value></pattern>
      <pattern><key>@bvr20983ccresult</key><value>${../../../../v:component[@id='cc']/v:filename/text()}</value></pattern>
      <pattern><key>@bvr20983scresult</key><value>${../../../../v:component[@id='sc']/v:filename/text()}</value></pattern>
      <pattern><key>@digiclockresult</key><value>${../../../../v:component[@id='digiclock']/v:filename/text()}</value></pattern>
      <pattern><key>@lsstgresult</key><value>${../../../../v:component[@id='lsstg']/v:filename/text()}</value></pattern>
      <pattern><key>@lstypeinforesult</key><value>${../../../../v:component[@id='lstypeinfo']/v:filename/text()}</value></pattern>
      <pattern><key>@msicabresult</key><value>${../../../../v:component[@id='msicab']/v:filename/text()}</value></pattern>
      <pattern><key>@bvr20983msgsresult</key><value>${../../../../v:component[@id='msgs']/v:filename/text()}</value></pattern>
      <pattern><key>@bvr20983result</key><value>${../../../../v:filename/text()}</value></pattern>
      <pattern><key>@bvr20983desc</key><value>${../../../../v:name/text()}</value></pattern>
      <pattern><key>@bvr20983msipackagecode</key><value>${../../../../v:msipackagecode/text()}</value></pattern>
      <pattern><key>@bvr20983msicompany</key><value>${../../../../v:company/text()}</value></pattern>
    </patch>

    <patch template="bvr20983.inf.tmpl" filename="bvr20983.2.inf">
      <pattern><key>@bvr20983msgsresult</key><value>${../../../../v:component[@id='msgs']/v:filename/text()}.dll</value></pattern>
      <pattern><key>@bvr20983ccresult</key><value>${../../../../v:component[@id='cc']/v:filename/text()}.dll</value></pattern>
      <pattern><key>@bvr20983scresult</key><value>${../../../../v:component[@id='sc']/v:filename/text()}.dll</value></pattern>
      <pattern><key>@digiclockresult</key><value>${../../../../v:component[@id='digiclock']/v:filename/text()}.exe</value></pattern>
      <pattern><key>@lsstgresult</key><value>${../../../../v:component[@id='lsstg']/v:filename/text()}.exe</value></pattern>
      <pattern><key>@lstypeinforesult</key><value>${../../../../v:component[@id='lstypeinfo']/v:filename/text()}.exe</value></pattern>
      <pattern><key>@bvr20983result</key><value>${../../../../v:filename/text()}.cab</value></pattern>
      <pattern><key>@publisher</key><value>${../../../../v:company/text()}</value></pattern>
      <pattern><key>@productprefix</key><value>${../../../../v:filename/text()}</value></pattern>
      <pattern><key>@productname</key><value>${../../../../v:name/text()}</value></pattern>
      <pattern><key>@productmajorversion</key><value>${../../../../v:version/@major}</value></pattern>
      <pattern><key>@productminorversion</key><value>${../../../../v:version/@minor}</value></pattern>
      <pattern><key>@productid</key><value>#{LCase("${../../../../@id}")}</value></pattern>
      
      <pattern><key>@bvr20983ocx1</key><value>${../../../../v:component[@id='cc']/v:type[@id='LED']/v:guid/text()}</value></pattern>
    </patch>

    <patch filename="bvr20983-prod.h">
      <pattern><key>(^#define.+verProdName.+")(.+)(")</key>                                    <value>$1${../../../../v:name/text()}$3</value></pattern>
      <pattern><key>(^#define.+verCompName.+")(.+)(")</key>                                    <value>$1${../../../../v:company/text()}$3</value></pattern>
      <pattern><key>(^#define.+verCopyright.+")(.+)(")</key>                                   <value>$1${../../../../v:copyright/text()}$3</value></pattern>
      <pattern><key>(^#define.+verProdVer1.+")([0-9]+[\.][0-9]+[\.][0-9]+[\.][0-9]+)(".*)</key><value>$1${../../../../v:version/@major}.${../../../../v:version/@minor}.${../../../../v:version/@fix}.${../../../../v:version/@rev}$3</value></pattern>
      <pattern><key>(^#define.+verProdVer[^0-9]+)([0-9]+[,][0-9]+[,][0-9]+[,][0-9]+)(.*)</key> <value>$1${../../../../v:version/@major},${../../../../v:version/@minor},${../../../../v:version/@fix},${../../../../v:version/@rev}$3</value></pattern>
      <pattern><key>(^#define.+verProdPrefix[ \t]+)(.*)</key>                                  <value>$1"${../../../../v:filename/text()}"</value></pattern>
    </patch>

    <component id="res" type="dll">
      <version major="1" minor="0" fix="0" rev="${rev}"/>
      <name>Resource Library</name>
      <msiguid>${msicomppattern}</msiguid>
      <msidir>BINDIR</msidir>
      <no>0001</no>
      <filename>${filenamepattern}</filename>

      <patch filename="bvr20983res-ver.h">
        <pattern><key>(^#define.+verFileVer1.+")([0-9]+[\.][0-9]+[\.][0-9]+[\.][0-9]+)(".*)</key><value>$1${../../../../v:version/@major}.${../../../../v:version/@minor}.${../../../../v:version/@fix}.${../../../../v:version/@rev}$3</value></pattern>
        <pattern><key>(^#define.+verFileVer[^0-9]+)([0-9]+[,][0-9]+[,][0-9]+[,][0-9]+)(.*)</key> <value>$1${../../../../v:version/@major},${../../../../v:version/@minor},${../../../../v:version/@fix},${../../../../v:version/@rev}$3</value></pattern>
        <pattern><key>(^#define.+verFileDesc.+")(.+)(")</key>                                    <value>$1${../../../../v:name/text()}$3</value></pattern>
        <pattern><key>(^#define.+verMakeDate.+")(.+)(")</key>                                    <value>$1${builddate}$3</value></pattern>
        <pattern><key>(^#define.+verOrigName.+")(.+)(")</key>                                    <value>$1${../../../../v:filename/text()}.${../../../../@type}$3</value></pattern>
        <pattern><key>(^#define.+verIntName.+")(.+)(")</key>                                     <value>$1${../../../../@id}$3</value></pattern>
        <pattern><key>(^#define.+verCompPrefix.+")(.+)(")</key>                                  <value>$1${../../../../@id}.${../../../../v:version/@major}$3</value></pattern>
        <pattern><key>(^#define.+verDebugVersion.+")(.+)(")</key>                                <value>$1${debugver}$3</value></pattern>
        <pattern><key>(^#define.+verMSIProdVersion.+")(.+)(")</key>                              <value>$1${../../../../../v:version/@major}.${../../../../../v:version/@minor}.0$3</value></pattern>
        <pattern><key>(^#define.+verMSIProdCode.+")(.+)(")</key>                                 <value>$1${../../../../../v:msiproductcode/text()}$3</value></pattern>
        <pattern><key>(^#define.+verMSIPackCode.+")(.+)(")</key>                                 <value>$1${../../../../../v:msipackagecode/text()}$3</value></pattern>
        <pattern><key>(^#define.+verMSIUpdCode.+")(.+)(")</key>                                  <value>$1${../../../../../v:msiupgradecode/text()}$3</value></pattern>

        <pattern><key>(^#define.+verAboutTitle.+")(.+)(")</key>                                  <value>$1${../../../../v:name/text()}$3</value></pattern>
        <pattern><key>(^#define.+verAboutText.+")(.+)(")</key>                                   <value>$1${../../../../v:name/text()} ${../../../../v:version/@major}.${../../../../v:version/@minor}.${../../../../v:version/@fix}.${../../../../v:version/@rev}$3</value></pattern>
      </patch>
    </component>

    <component id="msgs" type="dll">
      <version major="1" minor="0" fix="0" rev="${rev}"/>
      <name>Product installation and message component</name>
      <msiguid>${msicomppattern}</msiguid>
      <msidir>BINDIR</msidir>
      <no>0002</no>
      <filename>${filenamepattern}</filename>

      <patch filename="bvr20983msgs-ver.h">
        <pattern><key>(^#define.+verFileVer1.+")([0-9]+[\.][0-9]+[\.][0-9]+[\.][0-9]+)(".*)</key><value>$1${../../../../v:version/@major}.${../../../../v:version/@minor}.${../../../../v:version/@fix}.${../../../../v:version/@rev}$3</value></pattern>
        <pattern><key>(^#define.+verFileVer.+)([0-9]+[,][0-9]+[,][0-9]+[,][0-9]+)(.*)</key>      <value>$1${../../../../v:version/@major},${../../../../v:version/@minor},${../../../../v:version/@fix},${../../../../v:version/@rev}$3</value></pattern>
        <pattern><key>(^#define.+verFileDesc.+")(.+)(")</key>                                    <value>$1${../../../../v:name/text()}$3</value></pattern>
        <pattern><key>(^#define.+verMakeDate.+")(.+)(")</key>                                    <value>$1${builddate}$3</value></pattern>
        <pattern><key>(^#define.+verOrigName.+")(.+)(")</key>                                    <value>$1${../../../../v:filename/text()}.${../../../../@type}$3</value></pattern>
        <pattern><key>(^#define.+verIntName.+")(.+)(")</key>                                     <value>$1${../../../../@id}$3</value></pattern>
        <pattern><key>(^#define.+verCompPrefix.+")(.+)(")</key>                                  <value>$1${../../../../@id}.${../../../../v:version/@major}$3</value></pattern>
        <pattern><key>(^#define.+verDebugVersion.+")(.+)(")</key>                                <value>$1${debugver}$3</value></pattern>

        <pattern><key>(^#define.+verMSIProdVersion.+")(.+)(")</key>                              <value>$1${../../../../../v:version/@major}.${../../../../../v:version/@minor}.0$3</value></pattern>
        <pattern><key>(^#define.+verMSIProdCode.+")(.+)(")</key>                                 <value>$1${../../../../../v:msiproductcode/text()}$3</value></pattern>
        <pattern><key>(^#define.+verMSIPackCode.+")(.+)(")</key>                                 <value>$1${../../../../../v:msipackagecode/text()}$3</value></pattern>
        <pattern><key>(^#define.+verMSIUpdCode.+")(.+)(")</key>                                  <value>$1${../../../../../v:msiupgradecode/text()}$3</value></pattern>
      </patch>

      <patch template="bvr20983msgs.manifest.tmpl" filename="bvr20983msgs.manifest">
        <pattern><key>@ASSEMBLY_NAME</key>        <value>${../../../../v:filename/text()}</value></pattern>
        <pattern><key>@ASSEMBLY_VERSION</key>     <value>${../../../../v:version/@major}.${../../../../v:version/@minor}.${../../../../v:version/@fix}.${../../../../v:version/@rev}</value>                                   </pattern>
        <pattern><key>@ASSEMBLY_PUBKEYTOKEN</key> <value>${signpubkeytok}</value></pattern>
        <pattern><key>@CRT</key>                  <value>${crtlib}</value></pattern>
      </patch>
    </component>

    <component id="sc" type="dll">
      <version major="1" minor="0" fix="0" rev="${rev}"/>
      <name>Smartcard Library</name>
      <msiguid>${msicomppattern}</msiguid>
      <msidir>BINDIR</msidir>
      <no>0003</no>
      <filename>${filenamepattern}</filename>

      <patch filename="bvr20983sc-ver.h">
        <pattern><key>(^#define.+verFileVer1.+")([0-9]+[\.][0-9]+[\.][0-9]+[\.][0-9]+)(".*)</key><value>$1${../../../../v:version/@major}.${../../../../v:version/@minor}.${../../../../v:version/@fix}.${../../../../v:version/@rev}$3</value></pattern>
        <pattern><key>(^#define.+verFileVer[^0-9]+)([0-9]+[,][0-9]+[,][0-9]+[,][0-9]+)(.*)</key> <value>$1${../../../../v:version/@major},${../../../../v:version/@minor},${../../../../v:version/@fix},${../../../../v:version/@rev}$3</value></pattern>
        <pattern><key>(^#define.+verFileDesc.+")(.+)(")</key>                                    <value>$1${../../../../v:name/text()}$3</value></pattern>
        <pattern><key>(^#define.+verMakeDate.+")(.+)(")</key>                                    <value>$1${builddate}$3</value></pattern>
        <pattern><key>(^#define.+verOrigName.+")(.+)(")</key>                                    <value>$1${../../../../v:filename/text()}.${../../../../@type}$3</value></pattern>
        <pattern><key>(^#define.+verIntName.+")(.+)(")</key>                                     <value>$1${../../../../@id}$3</value></pattern>
        <pattern><key>(^#define.+verCompPrefix.+")(.+)(")</key>                                  <value>$1${../../../../@id}.${../../../../v:version/@major}$3</value></pattern>
        <pattern><key>(^#define.+verDebugVersion.+")(.+)(")</key>                                <value>$1${debugver}$3</value></pattern>
        <pattern><key>(^#define.+verMSIProdVersion.+")(.+)(")</key>                              <value>$1${../../../../../v:version/@major}.${../../../../../v:version/@minor}.0$3</value></pattern>
        <pattern><key>(^#define.+verMSIProdCode.+")(.+)(")</key>                                 <value>$1${../../../../../v:msiproductcode/text()}$3</value></pattern>
        <pattern><key>(^#define.+verMSIPackCode.+")(.+)(")</key>                                 <value>$1${../../../../../v:msipackagecode/text()}$3</value></pattern>
        <pattern><key>(^#define.+verMSIUpdCode.+")(.+)(")</key>                                  <value>$1${../../../../../v:msiupgradecode/text()}$3</value></pattern>
      </patch>

      <patch template="bvr20983sc.manifest.tmpl" filename="bvr20983sc.manifest">
        <pattern><key>@ASSEMBLY_NAME</key>        <value>${../../../../v:filename/text()}</value></pattern>
        <pattern><key>@ASSEMBLY_VERSION</key>     <value>${../../../../v:version/@major}.${../../../../v:version/@minor}.${../../../../v:version/@fix}.${../../../../v:version/@rev}</value>                                   </pattern>
        <pattern><key>@ASSEMBLY_PUBKEYTOKEN</key> <value>${signpubkeytok}</value></pattern>
        <pattern><key>@CRT</key>                  <value>${crtlib}</value></pattern>
      </patch>

      <type id="IAPDU" typeid="0002">
        <version major="1"/>
        <no>0001</no>
        <guid>${guidpattern}</guid>
      </type>

      <type id="IATR" typeid="0002">
        <version major="1"/>
        <no>0002</no>
        <guid>${guidpattern}</guid>
      </type>

      <type id="ISmartcard" typeid="0002">
        <version major="1"/>
        <no>0003</no>
        <guid>${guidpattern}</guid>
      </type>

      <type id="IWallet" typeid="0002">
        <version major="1"/>
        <no>0004</no>
        <guid>${guidpattern}</guid>
      </type>

      <type id="DISmartcardEvent" typeid="0004">
        <version major="1"/>
        <no>0001</no>
        <guid>${guidpattern}</guid>
      </type>

      <type id="Smartcard" typeid="0010">
        <version major="1"/>
        <no>0001</no>
        <guid>${guidpattern}</guid>
      </type>

      <type id="ATR" typeid="0010">
        <version major="1"/>
        <no>0002</no>
        <guid>${guidpattern}</guid>
      </type>

      <type id="Wallet" typeid="0012">
        <version major="1"/>
        <no>0001</no>
        <guid>${guidpattern}</guid>
      </type>

      <type id="ResponseEnum" typeid="0020">
        <version major="1"/>
        <no>0001</no>
        <guid>${guidpattern}</guid>
      </type>

      <type id="FeaturesEnum" typeid="0020">
        <version major="1"/>
        <no>0002</no>
        <guid>${guidpattern}</guid>
      </type>

      <type id="PinCodingEnum" typeid="0020">
        <version major="1"/>
        <no>0003</no>
        <guid>${guidpattern}</guid>
      </type>

      <type id="AttributesEnum" typeid="0020">
        <version major="1"/>
        <no>0004</no>
        <guid>${guidpattern}</guid>
      </type>
      
      <typelib id="SC" typeid="0000">
        <version major="1" minor="0"/>
        <no>0001</no>
        <guid>${typelibguidpattern}</guid>
        
        <patch template="ibvr20983-0000.tmpl" filename="ibvr20983-0000.odl">
          <pattern><key>@typelibVersion</key>      <value>${../../../../v:version/@major}.${../../../../v:version/@minor}</value></pattern>
          <pattern><key>@typelibGUID</key>         <value>${../../../../v:guid/text()}</value>                                   </pattern>
          <pattern><key>@typelibName</key>         <value>${../../../../../../@id}_${../../../../../../v:version/@major}_${../../../../@id}</value>                                             </pattern>
          
          <pattern><key>@DISmartcardEventGUID</key><value>${../../../../../v:type[@id='DISmartcardEvent']/v:guid/text()}</value> </pattern>
          <pattern><key>@IAPDUGUID</key>           <value>${../../../../../v:type[@id='IAPDU']/v:guid/text()}</value>            </pattern>
          <pattern><key>@IATRGUID</key>            <value>${../../../../../v:type[@id='IATR']/v:guid/text()}</value>             </pattern>
          <pattern><key>@ISmartcardGUID</key>      <value>${../../../../../v:type[@id='ISmartcard']/v:guid/text()}</value>       </pattern>
          <pattern><key>@IWalletGUID</key>         <value>${../../../../../v:type[@id='IWallet']/v:guid/text()}</value>          </pattern>

          <pattern><key>@ResponseEnumGUID</key>    <value>${../../../../../v:type[@id='ResponseEnum']/v:guid/text()}</value>     </pattern>
          <pattern><key>@FeaturesEnumGUID</key>    <value>${../../../../../v:type[@id='FeaturesEnum']/v:guid/text()}</value>     </pattern>
          <pattern><key>@PinCodingEnumGUID</key>   <value>${../../../../../v:type[@id='PinCodingEnum']/v:guid/text()}</value>    </pattern>
          <pattern><key>@AttributesEnumGUID</key>  <value>${../../../../../v:type[@id='AttributesEnum']/v:guid/text()}</value>   </pattern>

          <pattern><key>@smardcardGUID</key>       <value>${../../../../../v:type[@id='Smartcard']/v:guid/text()}</value>        </pattern>
          <pattern><key>@atrGUID</key>             <value>${../../../../../v:type[@id="ATR"]/v:guid/text()}</value>              </pattern>
          <pattern><key>@walletGUID</key>          <value>${../../../../../v:type[@id="Wallet"]/v:guid/text()}</value>           </pattern>
        </patch>

        <patch template="ibvr20983-0007.tmpl" filename="ibvr20983-0007.odl">
          <pattern><key>@typelibVersion</key>      <value>${../../../../v:version/@major}.${../../../../v:version/@minor}</value></pattern>
          <pattern><key>@typelibGUID</key>         <value>${../../../../v:guid/text()}</value>                                   </pattern>
          <pattern><key>@typelibName</key>         <value>${../../../../../../@id}_${../../../../../../v:version/@major}_${../../../../@id}</value>                                             </pattern>
          
          <pattern><key>@DISmartcardEventGUID</key><value>${../../../../../v:type[@id='DISmartcardEvent']/v:guid/text()}</value> </pattern>
          <pattern><key>@IAPDUGUID</key>           <value>${../../../../../v:type[@id='IAPDU']/v:guid/text()}</value>            </pattern>
          <pattern><key>@IATRGUID</key>            <value>${../../../../../v:type[@id='IATR']/v:guid/text()}</value>             </pattern>
          <pattern><key>@ISmartcardGUID</key>      <value>${../../../../../v:type[@id='ISmartcard']/v:guid/text()}</value>       </pattern>
          <pattern><key>@IWalletGUID</key>         <value>${../../../../../v:type[@id='IWallet']/v:guid/text()}</value>          </pattern>

          <pattern><key>@ResponseEnumGUID</key>    <value>${../../../../../v:type[@id='ResponseEnum']/v:guid/text()}</value>     </pattern>
          <pattern><key>@FeaturesEnumGUID</key>    <value>${../../../../../v:type[@id='FeaturesEnum']/v:guid/text()}</value>     </pattern>
          <pattern><key>@PinCodingEnumGUID</key>   <value>${../../../../../v:type[@id='PinCodingEnum']/v:guid/text()}</value>    </pattern>
          <pattern><key>@AttributesEnumGUID</key>  <value>${../../../../../v:type[@id='AttributesEnum']/v:guid/text()}</value>   </pattern>

          <pattern><key>@smardcardGUID</key>       <value>${../../../../../v:type[@id='Smartcard']/v:guid/text()}</value>        </pattern>
          <pattern><key>@atrGUID</key>             <value>${../../../../../v:type[@id="ATR"]/v:guid/text()}</value>              </pattern>
          <pattern><key>@walletGUID</key>          <value>${../../../../../v:type[@id="Wallet"]/v:guid/text()}</value>           </pattern>
        </patch>
      </typelib>
    </component>

    <component id="cc" type="dll">
      <version major="1" minor="0" fix="0" rev="${rev}"/>
      <name>Custom Control Library</name>
      <msiguid>${msicomppattern}</msiguid>
      <msidir>BINDIR</msidir>
      <no>0004</no>
      <filename>${filenamepattern}</filename>
      <patch filename="bvr20983cc-ver.h">
        <pattern><key>(^#define.+verFileVer1.+")([0-9]+[\.][0-9]+[\.][0-9]+[\.][0-9]+)(".*)</key><value>$1${../../../../v:version/@major}.${../../../../v:version/@minor}.${../../../../v:version/@fix}.${../../../../v:version/@rev}$3</value></pattern>
        <pattern><key>(^#define.+verFileVer.+)([0-9]+[,][0-9]+[,][0-9]+[,][0-9]+)(.*)</key>      <value>$1${../../../../v:version/@major},${../../../../v:version/@minor},${../../../../v:version/@fix},${../../../../v:version/@rev}$3</value></pattern>
        <pattern><key>(^#define.+verFileDesc.+")(.+)(")</key>                                    <value>$1${../../../../v:name/text()}$3</value></pattern>
        <pattern><key>(^#define.+verMakeDate.+")(.+)(")</key>                                    <value>$1${builddate}$3</value></pattern>
        <pattern><key>(^#define.+verOrigName.+")(.+)(")</key>                                    <value>$1${../../../../v:filename/text()}.${../../../../@type}$3</value></pattern>
        <pattern><key>(^#define.+verIntName.+")(.+)(")</key>                                     <value>$1${../../../../@id}$3</value></pattern>
        <pattern><key>(^#define.+verCompPrefix.+")(.+)(")</key>                                  <value>$1${../../../../@id}.${../../../../v:version/@major}$3</value></pattern>
        <pattern><key>(^#define.+verDebugVersion.+")(.+)(")</key>                                <value>$1${debugver}$3</value></pattern>
        <pattern><key>(^#define.+verMSIProdVersion.+")(.+)(")</key>                              <value>$1${../../../../../v:version/@major}.${../../../../../v:version/@minor}.0$3</value></pattern>
        <pattern><key>(^#define.+verMSIProdCode.+")(.+)(")</key>                                 <value>$1${../../../../../v:msiproductcode/text()}$3</value></pattern>
        <pattern><key>(^#define.+verMSIPackCode.+")(.+)(")</key>                                 <value>$1${../../../../../v:msipackagecode/text()}$3</value></pattern>
        <pattern><key>(^#define.+verMSIUpdCode.+")(.+)(")</key>                                  <value>$1${../../../../../v:msiupgradecode/text()}$3</value></pattern>

        <pattern><key>(^#define.+verAboutTitle.+")(.+)(")</key>                                  <value>$1${../../../../v:name/text()}$3</value></pattern>
        <pattern><key>(^#define.+verAboutText.+")(.+)(")</key>                                   <value>$1${../../../../v:name/text()} ${../../../../v:version/@major}.${../../../../v:version/@minor}.${../../../../v:version/@fix}.${../../../../v:version/@rev}$3</value></pattern>
      </patch>

      <patch template="bvr20983cc.manifest.tmpl" filename="bvr20983cc.manifest">
        <pattern><key>@ASSEMBLY_NAME</key>        <value>${../../../../v:filename/text()}</value></pattern>
        <pattern><key>@ASSEMBLY_VERSION</key>     <value>${../../../../v:version/@major}.${../../../../v:version/@minor}.${../../../../v:version/@fix}.${../../../../v:version/@rev}</value>                                   </pattern>
        <pattern><key>@ASSEMBLY_PUBKEYTOKEN</key> <value>${signpubkeytok}</value></pattern>
        <pattern><key>@CRT</key>                  <value>${crtlib}</value></pattern>
      </patch>

      <patch filename="led.html">
        <pattern><key>(classid="clsid:)(.*)(")</key>
                 <value>$1${../../../../v:type[@id='LED']/v:guid/text()}$3</value>
        </pattern>
        <pattern><key>(codebase=")(.*)(")</key>
                 <value>$1./${../../../../../v:filename/text()}.cab#version=${../../../../../v:version/@major},${../../../../../v:version/@minor},${../../../../../v:version/@fix},${../../../../../v:version/@rev}$3</value>
        </pattern>
      </patch>

      
      <type id="LED" typeid="0011">
        <version major="1"/>
        <no>0001</no>
        <guid>${guidpattern}</guid>
      </type>

      <type id="ILED" typeid="0002">
        <version major="1"/>
        <no>0001</no>
        <guid>${guidpattern}</guid>
      </type>

      <type id="DLEDEvent" typeid="0004">
        <version major="1"/>
        <no>0001</no>
        <guid>${guidpattern}</guid>
      </type>

      <type id="LEDPropertyPage" typeid="0013">
        <version major="1"/>
        <no>0001</no>
        <guid>${guidpattern}</guid>
      </type>

      <typelib id="CC" typeid="0000">
        <version major="1" minor="0"/>
        <no>0002</no>
        <guid>${typelibguidpattern}</guid>

        <patch template="ibvr20983cc-0000.tmpl" filename="ibvr20983cc-0000.odl">
          <pattern><key>@typelibVersion</key>      <value>${../../../../v:version/@major}.${../../../../v:version/@minor}</value></pattern>
          <pattern><key>@typelibGUID</key>         <value>${../../../../v:guid/text()}</value>                                   </pattern>
          <pattern><key>@typelibName</key>         <value>${../../../../../../@id}_${../../../../../../v:version/@major}_${../../../../@id}</value>                                             </pattern>
          <pattern><key>@LEDGUID</key>             <value>${../../../../../v:type[@id='LED']/v:guid/text()}</value>              </pattern>
          <pattern><key>@ILEDGUID</key>            <value>${../../../../../v:type[@id='ILED']/v:guid/text()}</value>             </pattern>
          <pattern><key>@LEDPropertyPageGUID</key> <value>${../../../../../v:type[@id='LEDPropertyPage']/v:guid/text()}</value>  </pattern>
          <pattern><key>@DLEDEventGUID</key>       <value>${../../../../../v:type[@id='DLEDEvent']/v:guid/text()}</value>        </pattern>
        </patch>
      </typelib>
    </component>

    <component id="digiclock" type="exe">
      <version major="1" minor="0" fix="0" rev="${rev}"/>
      <name>A digital clock</name>
      <msiguid>${msicomppattern}</msiguid>
      <msidir>BINDIR</msidir>
      <no>0005</no>
      <filename>${filenamepattern}</filename>
      <patch filename="digiclock-ver.h">
        <pattern><key>(^#define.+verFileVer1.+")([0-9]+[\.][0-9]+[\.][0-9]+[\.][0-9]+)(".*)</key><value>$1${../../../../v:version/@major}.${../../../../v:version/@minor}.${../../../../v:version/@fix}.${../../../../v:version/@rev}$3</value></pattern>
        <pattern><key>(^#define.+verFileVer.+)([0-9]+[,][0-9]+[,][0-9]+[,][0-9]+)(.*)</key>      <value>$1${../../../../v:version/@major},${../../../../v:version/@minor},${../../../../v:version/@fix},${../../../../v:version/@rev}$3</value></pattern>
        <pattern><key>(^#define.+verFileDesc.+")(.+)(")</key>                                    <value>$1${../../../../v:name/text()}$3</value></pattern>
        <pattern><key>(^#define.+verMakeDate.+")(.+)(")</key>                                    <value>$1${builddate}$3</value></pattern>
        <pattern><key>(^#define.+verOrigName.+")(.+)(")</key>                                    <value>$1${../../../../v:filename/text()}.${../../../../@type}$3</value></pattern>
        <pattern><key>(^#define.+verIntName.+")(.+)(")</key>                                     <value>$1${../../../../@id}$3</value></pattern>
        <pattern><key>(^#define.+verCompPrefix.+")(.+)(")</key>                                  <value>$1${../../../../@id}.${../../../../v:version/@major}$3</value></pattern>
        <pattern><key>(^#define.+verDebugVersion.+")(.+)(")</key>                                <value>$1${debugver}$3</value></pattern>

        <pattern><key>(^#define.+verMSIProdVersion.+")(.+)(")</key>                              <value>$1${../../../../../v:version/@major}.${../../../../../v:version/@minor}.0$3</value></pattern>
        <pattern><key>(^#define.+verMSIProdCode.+")(.+)(")</key>                                 <value>$1${../../../../../v:msiproductcode/text()}$3</value></pattern>
        <pattern><key>(^#define.+verMSIPackCode.+")(.+)(")</key>                                 <value>$1${../../../../../v:msipackagecode/text()}$3</value></pattern>
        <pattern><key>(^#define.+verMSIUpdCode.+")(.+)(")</key>                                  <value>$1${../../../../../v:msiupgradecode/text()}$3</value></pattern>
      </patch>

      <patch template="digiclock.manifest.tmpl" filename="digiclock.manifest">
        <pattern><key>@ASSEMBLY_NAME</key>        <value>${../../../../v:filename/text()}</value></pattern>
        <pattern><key>@ASSEMBLY_VERSION</key>     <value>${../../../../v:version/@major}.${../../../../v:version/@minor}.${../../../../v:version/@fix}.${../../../../v:version/@rev}</value>                                   </pattern>
        <pattern><key>@ASSEMBLY_PUBKEYTOKEN</key> <value>${signpubkeytok}</value></pattern>
        <pattern><key>@CRT</key>                  <value>${crtlib}</value></pattern>
      </patch>
    </component>

    <component id="lsstg" type="exe">
      <version major="1" minor="0" fix="0" rev="${rev}"/>
      <name>list COM structure storage</name>
      <msiguid>${msicomppattern}</msiguid>
      <msidir>BINDIR</msidir>
      <no>0006</no>
      <filename>${filenamepattern}</filename>

      <patch filename="lsstg-ver.h">
        <pattern><key>(^#define.+verFileVer1.+")([0-9]+[\.][0-9]+[\.][0-9]+[\.][0-9]+)(".*)</key><value>$1${../../../../v:version/@major}.${../../../../v:version/@minor}.${../../../../v:version/@fix}.${../../../../v:version/@rev}$3</value></pattern>
        <pattern><key>(^#define.+verFileVer.+)([0-9]+[,][0-9]+[,][0-9]+[,][0-9]+)(.*)</key>      <value>$1${../../../../v:version/@major},${../../../../v:version/@minor},${../../../../v:version/@fix},${../../../../v:version/@rev}$3</value></pattern>
        <pattern><key>(^#define.+verFileDesc.+")(.+)(")</key>                                    <value>$1${../../../../v:name/text()}$3</value></pattern>
        <pattern><key>(^#define.+verMakeDate.+")(.+)(")</key>                                    <value>$1${builddate}$3</value></pattern>
        <pattern><key>(^#define.+verOrigName.+")(.+)(")</key>                                    <value>$1${../../../../v:filename/text()}.${../../../../@type}$3</value></pattern>
        <pattern><key>(^#define.+verIntName.+")(.+)(")</key>                                     <value>$1${../../../../@id}$3</value></pattern>
        <pattern><key>(^#define.+verCompPrefix.+")(.+)(")</key>                                  <value>$1${../../../../@id}.${../../../../v:version/@major}$3</value></pattern>
        <pattern><key>(^#define.+verDebugVersion.+")(.+)(")</key>                                <value>$1${debugver}$3</value></pattern>

        <pattern><key>(^#define.+verMSIProdVersion.+")(.+)(")</key>                              <value>$1${../../../../../v:version/@major}.${../../../../../v:version/@minor}.0$3</value></pattern>
        <pattern><key>(^#define.+verMSIProdCode.+")(.+)(")</key>                                 <value>$1${../../../../../v:msiproductcode/text()}$3</value></pattern>
        <pattern><key>(^#define.+verMSIPackCode.+")(.+)(")</key>                                 <value>$1${../../../../../v:msipackagecode/text()}$3</value></pattern>
        <pattern><key>(^#define.+verMSIUpdCode.+")(.+)(")</key>                                  <value>$1${../../../../../v:msiupgradecode/text()}$3</value></pattern>
      </patch>

      <patch template="lsstg.manifest.tmpl" filename="lsstg.manifest">
        <pattern><key>@ASSEMBLY_NAME</key>        <value>${../../../../v:filename/text()}</value></pattern>
        <pattern><key>@ASSEMBLY_VERSION</key>     <value>${../../../../v:version/@major}.${../../../../v:version/@minor}.${../../../../v:version/@fix}.${../../../../v:version/@rev}</value>                                   </pattern>
        <pattern><key>@ASSEMBLY_PUBKEYTOKEN</key> <value>${signpubkeytok}</value></pattern>
        <pattern><key>@CRT</key>                  <value>${crtlib}</value></pattern>
      </patch>
    </component>

    <component id="lstypeinfo" type="exe">
      <version major="1" minor="0" fix="0" rev="${rev}"/>
      <name>list typeinfo of registered COM objects</name>
      <msiguid>${msicomppattern}</msiguid>
      <msidir>BINDIR</msidir>
      <no>0007</no>
      <filename>${filenamepattern}</filename>

      <patch filename="lstypeinfo-ver.h">
        <pattern><key>(^#define.+verFileVer1.+")([0-9]+[\.][0-9]+[\.][0-9]+[\.][0-9]+)(".*)</key><value>$1${../../../../v:version/@major}.${../../../../v:version/@minor}.${../../../../v:version/@fix}.${../../../../v:version/@rev}$3</value></pattern>
        <pattern><key>(^#define.+verFileVer.+)([0-9]+[,][0-9]+[,][0-9]+[,][0-9]+)(.*)</key>      <value>$1${../../../../v:version/@major},${../../../../v:version/@minor},${../../../../v:version/@fix},${../../../../v:version/@rev}$3</value></pattern>
        <pattern><key>(^#define.+verFileDesc.+")(.+)(")</key>                                    <value>$1${../../../../v:name/text()}$3</value></pattern>
        <pattern><key>(^#define.+verMakeDate.+")(.+)(")</key>                                    <value>$1${builddate}$3</value></pattern>
        <pattern><key>(^#define.+verOrigName.+")(.+)(")</key>                                    <value>$1${../../../../v:filename/text()}.${../../../../@type}$3</value></pattern>
        <pattern><key>(^#define.+verIntName.+")(.+)(")</key>                                     <value>$1${../../../../@id}$3</value></pattern>
        <pattern><key>(^#define.+verCompPrefix.+")(.+)(")</key>                                  <value>$1${../../../../@id}.${../../../../v:version/@major}$3</value></pattern>
        <pattern><key>(^#define.+verDebugVersion.+")(.+)(")</key>                                <value>$1${debugver}$3</value></pattern>

        <pattern><key>(^#define.+verMSIProdVersion.+")(.+)(")</key>                              <value>$1${../../../../../v:version/@major}.${../../../../../v:version/@minor}.0$3</value></pattern>
        <pattern><key>(^#define.+verMSIProdCode.+")(.+)(")</key>                                 <value>$1${../../../../../v:msiproductcode/text()}$3</value></pattern>
        <pattern><key>(^#define.+verMSIPackCode.+")(.+)(")</key>                                 <value>$1${../../../../../v:msipackagecode/text()}$3</value></pattern>
        <pattern><key>(^#define.+verMSIUpdCode.+")(.+)(")</key>                                  <value>$1${../../../../../v:msiupgradecode/text()}$3</value></pattern>
      </patch>

      <patch template="lstypeinfo.manifest.tmpl" filename="lstypeinfo.manifest">
        <pattern><key>@ASSEMBLY_NAME</key>        <value>${../../../../v:filename/text()}</value></pattern>
        <pattern><key>@ASSEMBLY_VERSION</key>     <value>${../../../../v:version/@major}.${../../../../v:version/@minor}.${../../../../v:version/@fix}.${../../../../v:version/@rev}</value>                                   </pattern>
        <pattern><key>@ASSEMBLY_PUBKEYTOKEN</key> <value>${signpubkeytok}</value></pattern>
        <pattern><key>@CRT</key>                  <value>${crtlib}</value></pattern>
      </patch>
    </component>

    <component id="msicab" type="exe">
      <version major="1" minor="0" fix="0" rev="${rev}"/>
      <name>create cabinet files and necessary msi information</name>
<!--      <msiguid>${msicomppattern}</msiguid> -->
      <no>0009</no>
      <filename>${filenamepattern}</filename>

      <patch filename="msicab-ver.h">
        <pattern><key>(^#define.+verFileVer1.+")([0-9]+[\.][0-9]+[\.][0-9]+[\.][0-9]+)(".*)</key><value>$1${../../../../v:version/@major}.${../../../../v:version/@minor}.${../../../../v:version/@fix}.${../../../../v:version/@rev}$3</value></pattern>
        <pattern><key>(^#define.+verFileVer.+)([0-9]+[,][0-9]+[,][0-9]+[,][0-9]+)(.*)</key>      <value>$1${../../../../v:version/@major},${../../../../v:version/@minor},${../../../../v:version/@fix},${../../../../v:version/@rev}$3</value></pattern>
        <pattern><key>(^#define.+verFileDesc.+")(.+)(")</key>                                    <value>$1${../../../../v:name/text()}$3</value></pattern>
        <pattern><key>(^#define.+verMakeDate.+")(.+)(")</key>                                    <value>$1${builddate}$3</value></pattern>
        <pattern><key>(^#define.+verOrigName.+")(.+)(")</key>                                    <value>$1${../../../../v:filename/text()}.${../../../../@type}$3</value></pattern>
        <pattern><key>(^#define.+verIntName.+")(.+)(")</key>                                     <value>$1${../../../../@id}$3</value></pattern>
        <pattern><key>(^#define.+verCompPrefix.+")(.+)(")</key>                                  <value>$1${../../../../@id}.${../../../../v:version/@major}$3</value></pattern>
        <pattern><key>(^#define.+verDebugVersion.+")(.+)(")</key>                                <value>$1${debugver}$3</value></pattern>
      </patch>

      <patch template="msicab.manifest.tmpl" filename="msicab.manifest">
        <pattern><key>@ASSEMBLY_NAME</key>        <value>${../../../../v:filename/text()}</value></pattern>
        <pattern><key>@ASSEMBLY_VERSION</key>     <value>${../../../../v:version/@major}.${../../../../v:version/@minor}.${../../../../v:version/@fix}.${../../../../v:version/@rev}</value>                                   </pattern>
        <pattern><key>@ASSEMBLY_PUBKEYTOKEN</key> <value>${signpubkeytok}</value></pattern>
        <pattern><key>@CRT</key>                  <value>${crtlib}</value></pattern>
      </patch>
    </component>

    <component id="doc" type="data">
      <version major="1" minor="0" fix="0" rev="${rev}"/>
      <name>documentation files</name>
      <msiguid>${msicomppattern}</msiguid>
      <msidir>DOCDIR</msidir>
      <no>0009</no>
      <filename>documentation</filename>
    </component>

    <component id="sample" type="data">
      <version major="1" minor="0" fix="0" rev="${rev}"/>
      <name>sample files</name>
      <msiguid>${msicomppattern}</msiguid>
      <msidir>SAMPLEDIR</msidir>
      <no>000A</no>
      <filename>samples</filename>
    </component>
  </product>
</versions>
